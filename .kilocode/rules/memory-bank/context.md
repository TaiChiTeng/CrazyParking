# CrazyParking 项目上下文

## 当前状态
CrazyParking 是一个基于 Cocos Creator 3.8.6 开发的微信小游戏，目前已完成核心游戏功能和存档系统。

## 已完成功能
1. **核心游戏机制**
   - 完整的汽车移动逻辑（向上、向左、向右三个方向）
   - 汽车联动移动系统
   - 10个关卡的地图和汽车数据
   - 通关检测和关卡切换

2. **存档系统**
   - 微信云存储支持
   - 本地存储备份
   - 自动保存和读取
   - 10关循环逻辑
   - 音频状态保存

3. **UI系统**
   - 主菜单界面
   - 游戏关卡界面
   - 通关界面
   - 全通关界面
   - 设置界面
   - 二次确认界面
   - 界面动画切换

4. **音频系统**
   - 背景音乐播放
   - 音效控制
   - 音频开关状态保存

5. **微信集成**
   - 微信分享功能
   - 微信小游戏适配

## 当前工作重点
1. **存档系统优化**
   - 存档系统已基本完成，包含完整的云存储和本地存储双重备份
   - 实现了容错机制，当云存储不可用时自动降级到本地存储
   - 包含完整的测试用例（SaveTest.ts）

2. **游戏逻辑完善**
   - CarManager 包含复杂的汽车移动逻辑，支持多种移动状态
   - 实现了汽车联动移动机制
   - 完成了通关检测和自动进度保存

## 技术债务和待优化项
1. **代码结构**
   - CarManager 类过于庞大（1700+行），需要重构
   - 部分硬编码常量需要提取到配置文件
   - 错误处理可以更加统一

2. **性能优化**
   - 动画系统可以进一步优化
   - 资源加载可以更加高效

3. **功能扩展**
   - 云函数目录已创建但文件未实现
   - 预留了11-16关的地图数据结构但未实现
   - 排行榜功能尚未实现

## 下一步计划
1. **短期目标**
   - 完善云函数实现
   - 优化 CarManager 代码结构
   - 添加更多关卡（11-20关）

2. **中期目标**
   - 实现微信好友排行榜
   - 添加成就系统
   - 优化游戏性能

3. **长期目标**
   - 添加新的游戏机制（如警车、匪车、石墩等）
   - 实现多人游戏模式
   - 扩展到其他平台

## 已知问题
1. 云函数目录存在但文件缺失，需要实现 saveGameData、loadGameData 和 clearGameData 三个云函数
2. 部分关卡地图数据预留但未实现（lv11-lv16）
3. CarManager 类过于复杂，需要重构以提高可维护性

## 开发环境
- **开发工具**: Cocos Creator 3.8.6
- **运行环境**: 微信开发者工具
- **版本控制**: Git
- **目标平台**: 微信小游戏